<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template inherit_id="sale.sale_order_portal_content" id="setu_pre_orders_portal_order_page" name="Sales Order">
            <xpath expr="//section[@id='details']" position="before">
                <div class="order_statusbar">
                    <t t-set="order" t-value="sale_order"/>
                    <t t-set="picking"
                       t-value="sale_order.picking_ids.filtered(lambda x: x.location_dest_id.usage == 'customer' and x.state != 'cancel')"/>
                    <h3>Order Status</h3>
                    <t t-foreach="picking" t-as="pick">
                        <div class="progress-bar">
                            <div class="pick-class" style="font-size:27px;color:black;padding-top: 5px;">
                                <t t-esc="pick.name"/>
                            </div>

                            <div class="progress-step">
                                <div class="step-description">
                                </div>
                            </div>
                            <div t-attf-class="#{'is-active' if not pick.preparation_date else ''} progress-step ">
                                <div class="step-count">1</div>
                                <div class="step-description">Picking</div>
                            </div>
                            <div t-attf-class="#{'is-active' if pick.preparation_date and not pick.x_studio_fecha_de_envio else ''} progress-step ">
                                <div class="step-count">2</div>
                                <div class="step-description">Preparation</div>
                            </div>
                            <div t-attf-class="#{'is-active' if pick.x_studio_fecha_de_envio and not pick.x_studio_fecha_de_entrega else ''} progress-step ">
                                <div class="step-count">3</div>
                                <div class="step-description">In Transit</div>
                            </div>
                            <div t-attf-class="#{'is-active' if order.state == 'done' and pick.x_studio_fecha_de_entrega else ''} progress-step ">
                                <div class="step-count">4</div>
                                <div class="step-description">Delivered</div>
                            </div>
                        </div>
                        <strong>Carrier : </strong> <span t-field="pick.shipping_carrier_id.name"/>
                        <br/>
                        <strong>Tracking Reference : </strong> <span t-field="pick.carrier_tracking_ref"/>
                        <br/>
                        <br/>
                    </t>
                </div>

            </xpath>

        </template>
        <template id="remove_sale_orders_picking_status" name="Remove Sale Orders Picking From Portal View"
                  inherit_id="sale_stock.sale_order_portal_content_inherit_sale_stock">
            <xpath expr="//div[@t-if='delivery_orders']" position="replace">

            </xpath>
        </template>
    </data>
</odoo>